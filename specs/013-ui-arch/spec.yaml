# Feature Specification (YAML)
# This is the source of truth. Markdown is auto-generated from this file.

name: ui-arch
number: 013
branch: feat/ui-arch
oneLiner: Restructure web UI component architecture with layered design system
summary: >
  Rebuild the web UI component hierarchy into a four-tier architecture
  (ui → common → layouts → features), reset Storybook from scratch,
  establish design system conventions, and create reusable composed
  components on top of shadcn/ui primitives.
phase: Planning
sizeEstimate: L

# Relationships
relatedFeatures:
  - '004-web-ui-component-library'
  - '007-ui-command'

technologies:
  - React 19
  - Next.js 16
  - Tailwind CSS v4
  - shadcn/ui
  - Storybook 8
  - Radix UI

relatedLinks:
  - https://ui.shadcn.com/docs
  - https://storybook.js.org/docs

# Open questions (must be resolved before implementation)
openQuestions: []

# Markdown content (the actual spec)
content: |
  ## Problem Statement

  The current web UI has a flat component structure with only `ui/` (shadcn primitives)
  and a single `features/` directory. There is no intermediate layer for shared composed
  components or layout shells. Storybook stories exist per-component but lack a cohesive
  design system story structure. As the application grows with settings pages, feature
  dashboards, and agent configuration, the current structure won't scale.

  Additionally, previous shadcn component additions may have leftover artifacts or
  inconsistencies that need cleanup before building on top of them.

  ## Goals

  1. **Four-tier component hierarchy**: `ui/` → `common/` → `layouts/` → `features/`
  2. **Clean Storybook reset**: Fresh configuration with design system documentation
  3. **Shared composed components**: Reusable building blocks (data-table, form-field, etc.)
  4. **Layout shells**: Dashboard, settings, sidebar, header patterns
  5. **Feature components**: Domain-specific UI organized by bounded context
  6. **Conventions & skills**: Established patterns for adding new components

  ## Success Criteria

  - [ ] Component directory restructured into `ui/`, `common/`, `layouts/`, `features/`
  - [ ] Storybook rebuilt from scratch with design system documentation
  - [ ] All existing shadcn/ui primitives verified working with stories
  - [ ] At least 3 common components implemented (e.g., page-header, empty-state, loading-skeleton)
  - [ ] At least 1 layout shell implemented (e.g., dashboard-layout with sidebar + header)
  - [ ] Feature components reorganized (settings/, version/, features/)
  - [ ] Barrel exports (index.ts) for each directory tier
  - [ ] Storybook builds successfully (`pnpm build:storybook`)
  - [ ] Web app builds successfully (`pnpm build:web`)
  - [ ] All existing functionality preserved (theme toggle, version page)

  ## Target Component Structure

  ```
  components/
  ├── ui/                           # shadcn/ui primitives (CLI-managed)
  │   ├── button.tsx
  │   ├── card.tsx
  │   ├── dialog.tsx
  │   └── index.ts
  │
  ├── common/                       # Shared composed components (cross-feature)
  │   ├── theme-toggle/
  │   │   ├── theme-toggle.tsx
  │   │   ├── theme-toggle.stories.tsx
  │   │   └── index.ts
  │   ├── search-input/
  │   ├── form-field/
  │   ├── data-table/
  │   ├── empty-state/
  │   ├── loading-skeleton/
  │   ├── page-header/
  │   ├── confirm-dialog/
  │   └── index.ts
  │
  ├── layouts/                      # Page shells and structural wrappers
  │   ├── dashboard-layout/
  │   ├── settings-layout/
  │   ├── sidebar/
  │   ├── header/
  │   └── index.ts
  │
  ├── features/                     # Domain-specific components
  │   ├── settings/
  │   ├── version/
  │   └── features/
  │       ├── feature-card.tsx
  │       ├── feature-list.tsx
  │       ├── task-board.tsx
  │       └── index.ts
  ```

  ## Affected Areas

  | Area | Impact | Reasoning |
  | --- | --- | --- |
  | `src/presentation/web/components/` | High | Full restructure of component hierarchy |
  | `.storybook/` | High | Reset configuration and story structure |
  | `src/presentation/web/app/` | Medium | Pages updated to use new layout components |
  | `docs/ui/` | Medium | Architecture docs updated to reflect new structure |
  | Root `package.json` | Low | Storybook dependency cleanup if needed |

  ## Dependencies

  - **004-web-ui-component-library** (Complete): Established the shadcn/ui + Tailwind v4 foundation
  - **007-ui-command** (Planning): Will consume layout components for the `shep ui` server

  ## Scope Boundaries

  **In scope:**
  - Component directory restructure
  - Storybook reset and design system stories
  - Common component implementations (page-header, empty-state, loading-skeleton, etc.)
  - Layout shell implementations (dashboard-layout, sidebar, header)
  - Feature component reorganization
  - Barrel exports and import path updates
  - Cleanup of any broken/leftover shadcn artifacts

  **Out of scope:**
  - New shadcn/ui primitives beyond what's already installed
  - Backend API integration
  - State management beyond what exists (useTheme)
  - E2E test coverage (deferred to feature-specific work)

  ## Size Estimate

  **L** - Restructures the entire component hierarchy, resets Storybook, implements
  multiple common and layout components, and updates all import paths. Touches many
  files across the web package but is primarily presentational work.

  ---

  _Generated by `/shep-kit:new-feature` — proceed with `/shep-kit:research`_
