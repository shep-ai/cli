# Tasks Document (YAML)
# This is the source of truth. Markdown is auto-generated from this file.

name: control-center-empty-state
number: 038
branch: feat/038-control-center-empty-state

tasks:
  - id: task-1
    title: Write tests for empty state conditional rendering
    description: >
      Add unit tests to verify that ControlCenterInner renders
      ControlCenterEmptyState when no repositoryNode nodes exist, and
      renders FeaturesCanvas when at least one repositoryNode exists.
    state: Todo
    dependencies: []
    acceptanceCriteria:
      - Test passes when nodes = [addRepositoryNode] → empty state rendered
      - Test passes when nodes = [repositoryNode, addRepositoryNode] → canvas rendered
      - Tests use data-testid attributes for assertions
    tdd:
      red:
        - Write test that renders ControlCenterInner with only addRepositoryNode and asserts data-testid="control-center-empty-state" is in the DOM
        - Write test that renders ControlCenterInner with a repositoryNode and asserts data-testid="features-canvas" is in the DOM
      green:
        - Will be implemented in task-2
      refactor: []
    estimatedEffort: S

  - id: task-2
    title: Implement hasRepositories conditional in ControlCenterInner
    description: >
      Add a derived boolean `hasRepositories` from nodes state. When false,
      render ControlCenterEmptyState with onRepositorySelect handler.
      When true, render the existing FeaturesCanvas and drawer components.
    state: Todo
    dependencies:
      - task-1
    acceptanceCriteria:
      - hasRepositories is derived from nodes.some(n => n.type === 'repositoryNode')
      - When hasRepositories is false, only ControlCenterEmptyState and NotificationPermissionBanner render
      - When hasRepositories is true, existing rendering is unchanged
      - All tests from task-1 pass
    tdd:
      red: []
      green:
        - Add hasRepositories derived from nodes in ControlCenterInner
        - Add early return with ControlCenterEmptyState when !hasRepositories
      refactor:
        - Verify no unused imports or dead code introduced
    estimatedEffort: S

  - id: task-3
    title: Verify stories and run full validation
    description: >
      Confirm existing Storybook stories render correctly. Run lint, typecheck,
      and all tests to ensure no regressions.
    state: Todo
    dependencies:
      - task-2
    acceptanceCriteria:
      - Existing control-center stories render without errors
      - pnpm lint passes
      - pnpm typecheck and typecheck:web pass
      - pnpm test passes
    tdd: null
    estimatedEffort: S

totalEstimate: S
openQuestions: []

content: |
  ## Task Summary

  3 tasks across 1 phase. All tasks are small (S).

  ## Acceptance Checklist

  - [ ] Tests verify empty state shown when no repository nodes
  - [ ] Tests verify canvas shown when repository nodes exist
  - [ ] ControlCenterInner conditionally renders based on hasRepositories
  - [ ] Lint, typecheck, and tests all pass
  - [ ] Stories render correctly

  ---

  _Generated by `/shep-kit:new-feature-fast`_
