# Plan Document (YAML)
# This is the source of truth. Markdown is auto-generated from this file.

name: control-center-empty-state
number: 038
branch: feat/038-control-center-empty-state
summary: >
  Single-phase implementation adding hasRepositories conditional rendering
  to ControlCenterInner with TDD approach.

phases:
  - id: phase-1
    name: Add empty state conditional rendering
    parallel: false
    taskIds:
      - task-1
      - task-2
      - task-3

filesToCreate: []

filesToModify:
  - path: src/presentation/web/components/features/control-center/control-center-inner.tsx
    reason: Add hasRepositories check and conditional rendering

openQuestions: []

content: |
  ## Architecture Overview

  The change is contained entirely within `ControlCenterInner`. No new components,
  hooks, or data flow changes are needed.

  ```
  ControlCenter
  └── ControlCenterInner
      ├── IF hasRepositories → FeaturesCanvas + Drawers (existing behavior)
      └── ELSE → ControlCenterEmptyState (new branch)
  ```

  ## Implementation Strategy

  Single phase with three tasks following TDD:

  1. **Write tests** for the conditional rendering behavior (RED)
  2. **Implement** the `hasRepositories` check in `ControlCenterInner` (GREEN)
  3. **Verify** stories and clean up (REFACTOR)

  The implementation is a single `useMemo`-derived boolean and a conditional return
  before the existing JSX. No refactoring of existing components is needed.

  ## Files to Modify

  | File | Change |
  | ---- | ------ |
  | `control-center-inner.tsx` | Add `hasRepositories` derived from `nodes`, conditional return |

  ## Testing Strategy (TDD: Tests FIRST)

  - **Unit test**: Render `ControlCenterInner` with nodes containing only `addRepositoryNode` → assert `ControlCenterEmptyState` is shown
  - **Unit test**: Render `ControlCenterInner` with a `repositoryNode` → assert `FeaturesCanvas` is shown
  - **Story verification**: Confirm existing stories still render correctly

  ## Risk Mitigation

  | Risk | Impact | Mitigation |
  | ---- | ------ | ---------- |
  | Empty state blocks drawer rendering | Low | Drawers are only relevant when features exist; empty state means no features |
  | Optimistic repo add doesn't transition | Low | `handleAddRepository` adds a `repositoryNode` type, which flips `hasRepositories` |

  ---

  _Generated by `/shep-kit:new-feature-fast`_
